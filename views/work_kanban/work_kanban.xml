<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>

        <record model="ir.actions.server" id="create_work_kanban_button">
            <field name="name">新增发送任务</field>
            <field name="state">code</field>
            <field name="type">ir.actions.server</field>
            <field name="model_id" ref="model_funenc_xa_station_work_kanban"/>
            <field name="condition">True</field>
            <field name="binding_model_id" ref="model_funenc_xa_station_work_kanban"/>
            <field name="binding_type">action_button</field>
            <field name="binding_action">工作看板</field>
            <field name="code">
                action = model.create_work_kanban()
            </field>
        </record>

        <record model="ir.ui.view" id="funenc_xa_station_work_kanban_list">
            <field name="name">funenc_xa_station_work_kanban_list</field>
            <field name="model">funenc_xa_station.work_kanban</field>
            <field name="arch" type="xml">
               <tree limit="15" create="0" class="noOpen">
                    <field name="task_type_id" string="任务类型"/>
                    <field name="task_priority" string="任务优先级"/>
                    <field name="task_end_time" string="到期时间"/>
                    <widget string="操作" name="treebtns" template="widget_edit_delete"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="funenc_xa_station_work_kanban_kanban">
            <field name="name">funenc_xa_station_work_kanban_list</field>
            <field name="model">funenc_xa_station.work_kanban</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_small_column" limit="15" create="0">
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_global_click">
                                <div class="oe_kanban_details">
                                    <ul>
                                        <li class="mb4">
                                            <h3>
                                                <strong>
                                                    <field name="task_type_id" string="任务类型"/>
                                                </strong>
                                            </h3>
                                        </li>
                                        <hr style="color: #0000FF；display:inline-block;height:10px !important;"/>
                                        <li>
                                            <field name="task_describe" string="任务描述"/>
                                        </li>
                                        <li><span>任务优先级:</span>
                                            <field name="task_priority" string="任务优先级"/>
                                        </li>
                                        <li style="color: #0000FF">
                                            <field name="task_end_time" string="到期时间"/>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record model="ir.ui.view" id="funenc_xa_station_work_kanban_form">
            <field name="name">funenc_xa_station_work_kanban_form</field>
            <field name="model">funenc_xa_station.work_kanban</field>
            <field name="arch" type="xml">
                <form>
                    <div class="container-fluid">
                        <sheet>
                            <group string="任务详情(发起的任务)">
                                <field name="task_originator_id" string="任务发起人"
                                       options="{'no_create':True,'no_open':True}"/>
                                <field name="originator_time" string="任务发起时间"/>
                                <field name="task_send_user_ids" string="任务接收人"
                                       context="{'tree_view_ref':'cdtct_dingtalk.users_list'}"
                                       options="{'no_create':True,'no_open':True}" />
                                <!--widget="many2many_tags"-->
                                <field name="task_start_time" string="任务开始时间"/>
                                <field name="task_end_time" string="任务结束时间"/>
                                <field name="task_priority" string="优先级"/>
                                <field name="task_type_id" string="任务类型"/>
                                <field name="task_describe" string="任务描述"/>
                                <field name="task_state" string="任务状态" readonly="1"/>
                                <field name="task_feedback" string="任务反馈"/>
                            </group>
                            <!--<notebook>-->
                                <!--<page string="任务完成情况">-->
                                    <!--<field name="child_ids">-->
                                        <!--<tree create="0" class="noOpen">-->
                                            <!--<field name="task_send_user_id" string="任务完成人"-->
                                                   <!--options="{'no_create':True,'no_open':True}"/>-->
                                            <!--<field name="completed_time" string="完成时间"/>-->
                                            <!--<field name="task_feedback" string="任务反馈"/>-->
                                        <!--</tree>-->
                                    <!--</field>-->
                                <!--</page>-->
                            <!--</notebook>-->
                        </sheet>
                        <footer>
                            <button name='work_kanban_save'
                                    string='确定'
                                    class='btn-primary'
                                    type='object'
                                    arrts="{'invisible':[('task_type','=','send_task'),('is_send','!=',1)]}"
                            />
                            <button name='check_task_complete'
                                    string='确认完成任务'
                                    class='btn-primary'
                                    type='object'
                                    arrts="{'invisible':[('task_type','!=','receive_state'),('is_send','!=',1)]}"
                            />
                        </footer>
                    </div>
                </form>
            </field>
        </record>


        <record model="ir.actions.act_window" id="xa_station_work_kanban_2_action">
            <field name="name">工作看板</field>
            <field name="res_model">funenc_xa_station.work_kanban</field>
            <field name="view_mode">tree,form,kanban</field>
            <field name="context">{'group_by':'task_type'}</field>
            <field name="view_ids" eval="[(5, 0, 0),
                                 (0, 0, {'view_mode': 'kanban', 'view_id': ref('funenc_xa_station_work_kanban_kanban')}),
                                 (0, 0, {'view_mode': 'tree', 'view_id': ref('funenc_xa_station_work_kanban_list')}),
                                  (0, 0, {'view_mode': 'form', 'view_id': ref('funenc_xa_station_work_kanban_form')})
                ]"/>
        </record>

        <!--<menuitem id="xa_station_work_kanban_2" name="工作看板"-->
                  <!--parent="funenc_xa_station.xa_station_work_kanban_1"-->
                  <!--action="xa_station_work_kanban_2_action"-->
        <!--/>-->


    </data>
</odoo>